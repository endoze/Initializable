<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Initializable by endoze</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Initializable</h1>
        <h2>Application Initializer Protocols</h2>
        <a href="https://github.com/endoze/Initializable" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <p>Initializable is a set of protocols that allow you to initialize third party
frameworks and other settings on app launch. It also allows your frameworks
to tie into <code>applicationDidEnterForeground:</code>.</p>

<p><a href="https://travis-ci.org/endoze/Initializable"><img src="https://travis-ci.org/endoze/Initializable.svg" alt="Build Status"></a>
<a href="https://coveralls.io/github/endoze/Initializable?branch=master"><img src="https://coveralls.io/repos/github/endoze/Initializable/badge.svg?branch=master" alt="Coverage Status"></a>
<a href="http://cocoapods.org/pods/Initializable"><img src="https://img.shields.io/cocoapods/l/Initializable.svg?style=flat" alt="License"></a>
<a href="http://cocoadocs.org/docsets/Initializable"><img src="https://img.shields.io/cocoapods/p/Initializable.svg?style=flat" alt="Platform"></a>
<a href="https://img.shields.io/cocoapods/v/Initializable.svg"><img src="https://img.shields.io/cocoapods/v/Initializable.svg?style=flat" alt="CocoaPods"></a>
<a href="https://github.com/Carthage/Carthage"><img src="https://img.shields.io/badge/Carthage-compatible-4BC51D.svg?style=flat" alt="Carthage compatible"></a></p>

<h2>
<a id="motivation" class="anchor" href="#motivation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Motivation</h2>

<p>When building new applications, how many times do you pollute
<code>application:didFinishLaunchingWithOptions:</code> with plenty of code initializing
third party frameworks or other app wide settings? This framework is designed
to help cut down on the noise in your AppDelegate and allow this code to be
separated into objects each with their own responsibility.</p>

<h2>
<a id="features" class="anchor" href="#features" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Features</h2>

<ul>
<li>Small public API surface</li>
<li>Works with your own custom objects</li>
<li>Customizeable via method implementation</li>
<li>Well documented</li>
<li>Tested</li>
<li>Support For Cocoapods/Carthage integration</li>
</ul>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h2>

<h3>
<a id="carthage" class="anchor" href="#carthage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Carthage</h3>

<p>Add the following to your Cartfile:</p>

<pre><code>github "Endoze/Initializable"
</code></pre>

<p>Then add the framework as a linked framework.</p>

<h3>
<a id="cocoapods" class="anchor" href="#cocoapods" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>CocoaPods</h3>

<p>Add the following to your Podfile:</p>

<pre><code>use_frameworks!


pod 'Initializable'
</code></pre>

<p>Then run <code>pod install</code></p>

<h2>
<a id="show-me-the-code" class="anchor" href="#show-me-the-code" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Show me the code</h2>

<h3>
<a id="if-your-language-of-choice-is-swift" class="anchor" href="#if-your-language-of-choice-is-swift" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>If your language of choice is Swift</h3>

<p>You need to implement a couple objects that conform to the Configurable
protocol and the Initializable protocol.</p>

<div class="highlight highlight-source-swift"><pre><span class="pl-c">// Configuration.swift</span>

<span class="pl-k">class</span> Configuration: NSObject, Configurable {
  <span class="pl-k">static</span> <span class="pl-k">let</span> sharedConfiguration <span class="pl-k">=</span> Configuration()

  <span class="pl-k">var</span> serviceStorage: [<span class="pl-c1">String</span> <span class="pl-k">:</span> [<span class="pl-c1">Int</span> <span class="pl-k">:</span> [<span class="pl-c1">String</span> <span class="pl-k">:</span> <span class="pl-c1">String</span>]]] <span class="pl-k">=</span> [<span class="pl-k">:</span>]

  <span class="pl-k">override</span> <span class="pl-k">init</span>() {
    serviceStorage <span class="pl-k">=</span> [
      <span class="pl-s"><span class="pl-pds">"</span>FakeService<span class="pl-pds">"</span></span> <span class="pl-k">:</span> [
        ReleaseStage<span class="pl-k">.</span>Development<span class="pl-k">.</span><span class="pl-c1">rawValue</span> <span class="pl-k">:</span> [
          <span class="pl-s"><span class="pl-pds">"</span>ApiKey<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>abc123<span class="pl-pds">"</span></span>
        ]
      ]
    ]
  }

  <span class="pl-k">static</span> <span class="pl-k">func</span> <span class="pl-en">defaultConfiguration</span>() <span class="pl-k">-&gt;</span> Configurable {
    <span class="pl-k">return</span> sharedConfiguration
  }

  <span class="pl-k">func</span> <span class="pl-en">currentStage</span>() <span class="pl-k">-&gt;</span> ReleaseStage {
    <span class="pl-k">return</span> <span class="pl-k">.</span>Development
  }

  <span class="pl-c">// Notice we don't define `configurationValueForService:key:` in Swift</span>
  <span class="pl-c">// this is because of the default implementation provided by the</span>
  <span class="pl-c">// extension to Configurable</span>
}</pre></div>

<div class="highlight highlight-source-swift"><pre><span class="pl-c">// ThirdpartyInitializer.swift</span>

<span class="pl-k">import</span> <span class="pl-c1">Initializable</span>

<span class="pl-k">class</span> ThirdpartyInitializer: NSObject, Initializable {
  <span class="pl-k">func</span> <span class="pl-en">performWithConfiguration</span>(configuration: Configuration) {
    <span class="pl-k">let</span> apiKey <span class="pl-k">=</span> configuration<span class="pl-k">.</span>configurationValueForService(<span class="pl-s"><span class="pl-pds">"</span>ThirdParty<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>apiKey<span class="pl-pds">"</span></span>)
    <span class="pl-k">let</span> _ <span class="pl-k">=</span> Thirdparty(apiKey: apiKey)
  }

  <span class="pl-k">func</span> <span class="pl-en">shouldPerformWhenApplicationEntersForeground</span>() <span class="pl-k">-&gt;</span> <span class="pl-c1">Bool</span> {
    <span class="pl-k">return</span> <span class="pl-c1">false</span>
  }
}</pre></div>

<p>Then jump into your Application Delegate and hook the initializer(s) into
application lifecycle methods.</p>

<div class="highlight highlight-source-swift"><pre><span class="pl-c">// AppDelegate.swift</span>

<span class="pl-k">import</span> <span class="pl-c1">UIKit</span>

<span class="pl-k">@UIApplicationMain</span>
<span class="pl-k">class</span> AppDelegate: UIResponder, UIApplicationDelegate {
  <span class="pl-k">let</span> initializers: [Initializable] <span class="pl-k">=</span> [
    ThirdPartyInitializer(),
  ]
  <span class="pl-k">let</span> configuration <span class="pl-k">=</span> Configuration<span class="pl-k">.</span>defaultConfiguration()

  <span class="pl-k">func</span> <span class="pl-en">application</span>(application: UIApplication, <span class="pl-en">didFinishLaunchingWithOptions</span> <span class="pl-smi">launchOptions</span>: [NSObject: <span class="pl-c1">AnyObject</span>]?) <span class="pl-k">-&gt;</span> <span class="pl-c1">Bool</span> {
    <span class="pl-k">for</span> initializer <span class="pl-k">in</span> initializers {
      initializer<span class="pl-k">.</span>performWithConfiguration(configuration: configuration)
    }

    <span class="pl-k">return</span> <span class="pl-c1">true</span>
  }

  <span class="pl-k">func</span> <span class="pl-en">applicationWillEnterForeground</span>(application: UIApplication) {
    <span class="pl-k">for</span> initializer <span class="pl-k">in</span> initializers {
      <span class="pl-k">if</span> initializer<span class="pl-k">.</span>respondsToSelector(#selector(Initializable<span class="pl-k">.</span>shouldPerformWhenApplicationEntersForeground)) {
        initializer<span class="pl-k">.</span>performWithConfiguration(configuration)
      }
    }
  }

  <span class="pl-c">// ...</span>
}</pre></div>

<h3>
<a id="or-if-you-prefer-objective-c" class="anchor" href="#or-if-you-prefer-objective-c" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Or if you prefer Objective-C</h3>

<p>You need to implement a couple objects that conform to the Configurable
protocol and the Initializable protocol.</p>

<div class="highlight highlight-source-objc"><pre><span class="pl-c">// Configuration.h</span>

#<span class="pl-k">import</span> <span class="pl-s"><span class="pl-pds">&lt;</span>Foundation/Foundation.h<span class="pl-pds">&gt;</span></span>

@import Initializable;

<span class="pl-k">@interface</span> <span class="pl-en">Configuration</span> : <span class="pl-e">NSObject</span> &lt;Configurable&gt;

<span class="pl-k">@property</span> (<span class="pl-k">nonatomic</span>, <span class="pl-k">copy</span>) <span class="pl-c1">NSDictionary</span>&lt;NSString *, NSDictionary&lt;NSNumber *, NSDictionary&lt;NSString *, NSString *&gt; *&gt; *&gt; *serviceStorage;

<span class="pl-k">@end</span></pre></div>

<div class="highlight highlight-source-objc"><pre><span class="pl-c">// Configuration.m</span>

#<span class="pl-k">import</span> <span class="pl-s"><span class="pl-pds">"</span>Configuration.h<span class="pl-pds">"</span></span>

<span class="pl-k">@implementation</span> <span class="pl-en">Configuration</span>

+ (Configuration *)<span class="pl-en">defaultConfiguration</span>
{
  <span class="pl-k">static</span> <span class="pl-k">id</span> instance = <span class="pl-c1">nil</span>;
  <span class="pl-k">static</span> <span class="pl-c1">dispatch_once_t</span> onceToken;

  <span class="pl-c1">dispatch_once</span>(&amp;onceToken, ^{
      instance = [[<span class="pl-v">self</span> <span class="pl-c1">alloc</span>] <span class="pl-c1">init</span>];
  });

  <span class="pl-k">return</span> instance;
}

- (ReleaseStage)<span class="pl-en">currentStage</span>
{
  <span class="pl-k">return</span> ReleaseStageDevelopment;
}

- (<span class="pl-c1">NSDictionary</span> *)<span class="pl-en">serviceStorage</span>
{
  <span class="pl-k">if</span> (!_serviceStorage) {
    _serviceStorage = @{
      @(ReleaseStageDevelopment) : @{
        <span class="pl-s"><span class="pl-pds">@"</span>FakeService<span class="pl-pds">"</span></span>: @{
          <span class="pl-s"><span class="pl-pds">@"</span>apiKey<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">@"</span>abc123<span class="pl-pds">"</span></span>
        }
      }
    };
  }

  <span class="pl-k">return</span> _serviceStorage;
}

<span class="pl-c">// Notice we define `configurationValueForService:key:` in Objective-C</span>
<span class="pl-c">// this is because the default implementation provided by the extension</span>
<span class="pl-c">// to Configurable is not visible to Objective-C code.</span>
- (<span class="pl-c1">NSString</span> *)<span class="pl-en">configurationValueForService</span><span class="pl-en">:</span>(<span class="pl-c1">NSString</span> *)<span class="pl-smi">service</span> <span class="pl-en">key</span><span class="pl-en">:</span>(<span class="pl-c1">NSString</span> *)<span class="pl-smi">key</span>
{
  Configuration *configuration = [Configuration <span class="pl-c1">defaultConfiguration</span>];
  <span class="pl-c1">NSDictionary</span> *serviceStorage = [configuration <span class="pl-c1">serviceStorage</span>];
  <span class="pl-c1">NSDictionary</span> *stageStorage = serviceStorage[@([configuration <span class="pl-c1">currentStage</span>])];
  <span class="pl-c1">NSDictionary</span> *serviceKeys;

  <span class="pl-k">if</span> (stageStorage) {
    <span class="pl-k">if</span> ((serviceKeys = stageStorage[service])) {
      <span class="pl-k">return</span> serviceKeys[key];
    }
  }

  <span class="pl-k">return</span> <span class="pl-c1">nil</span>;
}

<span class="pl-k">@end</span></pre></div>

<div class="highlight highlight-source-objc"><pre><span class="pl-c">// ThirdpartyInitializer.h</span>

#<span class="pl-k">import</span> <span class="pl-s"><span class="pl-pds">&lt;</span>Foundation/Foundation.h<span class="pl-pds">&gt;</span></span>

@import Initializable;

<span class="pl-k">@interface</span> <span class="pl-en">ThirdpartyInitializer</span> &lt;Initializable&gt;

<span class="pl-k">@end</span></pre></div>

<div class="highlight highlight-source-objc"><pre><span class="pl-c">// ThirdpartyInitializer.m</span>

#<span class="pl-k">import</span> <span class="pl-s"><span class="pl-pds">"</span>ThirdpartyInitializer.h<span class="pl-pds">"</span></span>

<span class="pl-k">@implementation</span> <span class="pl-en">ThirdpartyInitializer</span>

<span class="pl-c">// Notice we substitute id&lt;Configurable&gt; here for our custom class that</span>
<span class="pl-c">// implements the Configurable protocol in the method implementation</span>
- (<span class="pl-k">void</span>)<span class="pl-en">performWithConfiguration</span><span class="pl-en">:</span>(Configuration *)<span class="pl-smi">configuration</span>
{
  <span class="pl-c1">NSString</span> *apiKey = [configuration <span class="pl-c1">configurationValueForService:</span><span class="pl-s"><span class="pl-pds">@"</span>Thirdparty<span class="pl-pds">"</span></span> <span class="pl-c1">key:</span><span class="pl-s"><span class="pl-pds">@"</span>apiKey<span class="pl-pds">"</span></span>];
  [Thirdparty <span class="pl-c1">initWithApiKey:</span>apiKey];
}

- (<span class="pl-k">BOOL</span>)<span class="pl-en">shouldPerformWhenApplicationEntersForeground</span>
{
  <span class="pl-k">return</span> <span class="pl-c1">NO</span>;
}

<span class="pl-k">@end</span></pre></div>

<p>Then jump into your Application Delegate and hook the initializer(s) into
application lifecycle methods.</p>

<div class="highlight highlight-source-objc"><pre><span class="pl-c">// AppDelegate.m</span>

#<span class="pl-k">import</span> <span class="pl-s"><span class="pl-pds">"</span>AppDelegate.h<span class="pl-pds">"</span></span>

@import Initializable;

<span class="pl-k">@interface</span> <span class="pl-en">AppDelegate</span> ()

<span class="pl-k">@property</span> (<span class="pl-k">nonatomic</span>, <span class="pl-k">strong</span>) <span class="pl-c1">NSArray</span>&lt;id&lt;Initializable&gt;&gt; *initializers;

<span class="pl-k">@end</span>

<span class="pl-k">@implementation</span> <span class="pl-en">AppDelegate</span>

- (<span class="pl-k">void</span>)<span class="pl-en">application</span><span class="pl-en">:</span>(UIApplication *)<span class="pl-smi">application</span> <span class="pl-en">didFinishLaunchingWithOptions</span><span class="pl-en">:</span>(<span class="pl-c1">NSDictionary</span> *)<span class="pl-smi">launchOptions</span>
{
  [<span class="pl-v">self</span>.initializers <span class="pl-c1">makeObjectsPerformSelector:</span><span class="pl-k">@selector</span>(<span class="pl-c1">performWithConfiguration:</span>) <span class="pl-c1">withObject:</span>[Configuration <span class="pl-c1">defaultConfiguration</span>]];

  <span class="pl-k">return</span> <span class="pl-c1">YES</span>
}

- (<span class="pl-k">void</span>)<span class="pl-en">applicationWillEnterForeground</span><span class="pl-en">:</span>(UIApplication *)<span class="pl-smi">application</span>
{
  [<span class="pl-v">self</span>.initializers <span class="pl-c1">enumerateObjectsUsingBlock:</span>^<span class="pl-c1">void</span>(<span class="pl-k">id</span>&lt;Initializer&gt; initializer, <span class="pl-k">NSUInteger</span> <span class="pl-c1">index</span>, <span class="pl-k">BOOL</span> *stop) {
    <span class="pl-k">if</span> ([initializer <span class="pl-c1">respondsToSelector:</span><span class="pl-k">@selector</span>(<span class="pl-c1">shouldPerformWhenApplicationEntersForeground</span>)] &amp;&amp;
        [initializer <span class="pl-c1">shouldPerformWhenApplicationEntersForeground</span>]) {
      [initializer <span class="pl-c1">performWithConfiguration:</span>[Configuration <span class="pl-c1">defaultConfiguration</span>]];
    }
  }];
}

- (<span class="pl-c1">NSArray</span>&lt;id &lt;Initializer&gt;&gt; *)<span class="pl-en">initializers</span>
{
  <span class="pl-k">if</span> (!_initializers) {
    _initializers = @[
      [ThirdPartyInitializer <span class="pl-c1">new</span>],
    ];
  }

  <span class="pl-k">return</span> _initializers;
}

<span class="pl-k">@end</span></pre></div>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/endoze/Initializable/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/endoze/Initializable/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/endoze/Initializable"></a> is maintained by <a href="https://github.com/endoze">endoze</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
